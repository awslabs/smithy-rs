# What is this??
# badssl seems to be abandoned. The orginal dockerfile was based on ubuntu 16.04 and all the bits were rotting.
# I've updated the dockerfiel to ubuntu 22.04 which will hopefully let everything limp along a little longer.
FROM ubuntu:22.04
MAINTAINER April King <april@pokeinthe.io>
EXPOSE 80 443
RUN apt-get update && apt-get install -y apt-transport-https
RUN apt-get install -y software-properties-common
RUN apt-get update && apt-get install -y \
    build-essential \
    git \
    libffi-dev \
    make \
    nginx \
    ruby3.0 \
    ruby3.0-dev
#RUN gem update --system
RUN gem install jekyll

# Install badssl.com
ADD . badssl.com
WORKDIR badssl.com
RUN make inside-docker

RUN sed -i 's/SECLEVEL=2/SECLEVEL=1/' /etc/ssl/openssl.cnf

# Start things up!
CMD nginx && tail -f /var/log/nginx/access.log /var/log/nginx/error.log
