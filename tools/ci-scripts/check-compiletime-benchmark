#!/bin/bash
#
# Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.
# SPDX-License-Identifier: Apache-2.0
#
set -eux


touch /tmp/compiletime-benchmark.txt

echo "START
iam
+ cd /mnt/rust/projects/smithy-rs/aws/sdk/build/aws-sdk/sdk/iam
+ export CARGORUSTFLAG=
+ CARGORUSTFLAG=
+ cargo build
+ cargo clean
+ time '--format=%e seconds' bash -c 'cargo build  &> /dev/null'
201.92 seconds
+ cargo clean
+ time '--format=%e seconds' bash -c 'cargo build --release  &> /dev/null'
217.43 seconds
+ cargo clean
+ export 'CARGORUSTFLAG=--cfg aws_sdk_unstable'
+ CARGORUSTFLAG='--cfg aws_sdk_unstable'
+ time '--format=%e seconds' bash -c 'cargo build --all-features &>/dev/null'
215.10 seconds
+ cargo clean
+ time '--format=%e seconds' bash -c 'cargo build --all-features --release &>/dev/null'
187.71 seconds
+ cargo clean
END" >> /tmp/compiletime-benchmark.txt

python3 tools/compiletime-benchmark/format.py
